---
title: "Final Project"
author: "Cassie York"
format: html
editor: visual
---

## Quarto

```{r}
remotes::install_github("higgi13425/medicaldata")
library(tidyverse)
library(gtsummary)
library(medicaldata)

covid <- medicaldata::covid_testing %>%
	mutate(result = factor(result, labels = c("Invalid", "Negative", "Positive")),
				 demo_group = factor(demo_group, labels = c("Client", "Misc Adult", "Other Adult", "Patient", "Unidentified")),
				 gender = factor(gender, labels = c("Female", "Male")))

```

```{r}
tbl_summary(
  covid,
  by = gender,
  include = c(age, demo_group, result, drive_thru_ind, pan_day, col_rec_tat),
  label = list(
  	age ~ "Age (Years)",
  	demo_group ~ "Type of Subject",
  	result ~ "COVID Test Result",
  	drive_thru_ind ~ "Specimen Collected via Drive-Thru Site",
  	pan_day ~ "Day After Start of Pandemic in Which Specimen Was Collected (Days)",
  	col_rec_tat ~ "Time Elapsed Between Collect Time and Receive Time (Hours)")) %>%
  add_p(test = list(all_continuous() ~ "t.test", 
                    all_categorical() ~ "chisq.test")) %>% 
  add_overall() %>% 
  bold_labels() %>% 
  modify_footnote(update = everything() ~ NA) %>% 
  modify_header(label = "**Variable**", p.value = "**P**")
```

```{r}
tbl_uvregression(
	covid,
	y = age,
	include = c(age, demo_group, result, drive_thru_ind, pan_day, col_rec_tat),
	method = lm)

linear_model <- covid %>%
	lm(gender ~ age + demo_group + result)

tbl_regression(
	linear_model,
	intercept = TRUE,
	label = list(
  	age ~ "Age (Years)",
  	demo_group ~ "Type of Subject",
  	result ~ "COVID Test Result",
  	drive_thru_ind ~ "Specimen Collected via Drive-Thru Site",
  	pan_day ~ "Day After Start of Pandemic in Which Specimen Was Collected (Days)",
  	col_rec_tat ~ "Time Elapsed Between Collect Time and Receive Time (Hours)"))
```

```{r}
covid %>%
	ggplot(aes(x = result, fill = gender)) +
	geom_bar(position = "dodge") +
	labs(x = "Test Result", y = "Count")
```

